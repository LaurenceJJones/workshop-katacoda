Now how can we add the CrowdSec Security Engine in our processes to speed up the SOC analyst work?

## CrowdSec Security Engine

The CrowdSec Security Engine is a lightweight software that can be installed on your servers to protect them from attacks. However, a key feature of the Security Engine is to load "cold logs" and analyze them to find attacks that have already happened. This is what we are going to do now.

The DevOps team have already installed the Security Engine on the server and have configured it. We just need to manually run the Security Engine to analyze the logs.

Lets start in the same place we did before, and load the webserver logs and see what CrowdSec can inform us about the logs.

`crowdsec -dsn file:///var/log/pwn.log -type nginx -no-api 2>&1 | grep performed`{{execute}}

**NOTE: This command will take a minute to run and we are only grepping for the word performed since crowdsec in cold log mode can output general logs**

We can see that CrowdSec has detected the same attacks that we found earlier. However, this is automated and can be integrated within workflows to speed up the SOC analysts work.

Now we want to inspect the alerts that CrowdSec has generated. We can do this by running the following command:

`cscli alerts list``{{execute}}

Find an alert that has been generated by the Security Engine and inspect it. You can do this by running the following command:

`cscli alerts inspect <<ALERT_ID>> -d`{{execute}}

My recommendation is to run with the `-oraw` flag to get the raw output of the alert. This will give you a better understanding of the alert.

You can copy the `events`{{}} sections as that contains the initial attack that was detected by CrowdSec.

If you want to get all metadata information in one command you can run the following command:

**NOTE you need to install jq for this to work**

`cscli alerts list -ojson | jq -r '.[] | "####\(.source.value)####", (.events[].meta[] | "\(.key): \(.value)")'`{{execute}}