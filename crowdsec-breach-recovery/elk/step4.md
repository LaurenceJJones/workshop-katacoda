How can we add the CrowdSec Security Engine to our process to speed up SOC analyst work?

## CrowdSec Security Engine

The CrowdSec Security Engine is a lightweight software that can be installed on your servers to protect them from attacks. However, a key feature of the Security Engine is to load "cold logs" and analyze them to find attacks that have already happened. This is what we are going to do now.

The DevOps team has already installed and configured the Security Engine on the server. We only need to run it manually to analyze the logs.

Let's start where we did before: load the web server logs and see what CrowdSec can tell us.

`crowdsec -dsn file:///var/log/pwn.log -type nginx -no-api 2>&1 | grep performed`{{exec}}

**NOTE: This command takes about a minute. We grep for `performed` because CrowdSec in cold-log mode also outputs general logs.**

We can see that CrowdSec detected the same attacks we found earlier. This is automated and can be integrated into workflows to speed up SOC analyst work.

Now we want to inspect the alerts that CrowdSec has generated. We can do this by running the following command:

`cscli alerts list`{{exec}}

Find an alert that has been generated by the Security Engine and inspect it. You can do this by running the following command:

`cscli alerts inspect <<ALERT_ID>> -d`{{exec}}

My recommendation is to run with the `-oraw` flag to get the raw output of the alert. This will give you a better understanding of the alert.

You can copy the `events`{{}} section, as it contains the initial attack detected by CrowdSec.

If you want to get all metadata information in one command you can run the following command:

**NOTE you need to install jq for this to work**

`apt install jq -y`{{exec}}

`cscli alerts list -ojson | jq -r '.[] | "####\(.source.value)####", (.events[].meta[] | "\(.key): \(.value)")'`{{exec}}

If you want to append the data directly to your report, redirect the output to a file and then copy it into your report.
