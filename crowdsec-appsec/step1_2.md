Let's set up the CrowdSec AppSec Component step by step so we can understand how it works.

In this step, we will configure the acquisition for the AppSec component.

This is a special acquisition that will listen on a TCP socket for requests from web servers. (Unix sockets support soon)

In this workshop, we will use port 4242 on the loopback interface for the acquisition.

**It is is important to note that this port should not be exposed to the internet unless you firewall/restrict it correctly**

### Yaml configuration example

```yaml
source: appsec
name: myappsec
appsec_config: crowdsecurity/virtual-patching
listen_addr: 127.0.0.1:4242
labels:
  type: appsec
```{{}}

* `source: appsec`{{}}: This is the source of the acquisition, in this case it is the AppSec component. (It must be `appsec`{{}}, putting any other value will cause the acquisition to fail)

* `appsec_config: crowdsecurity/virtual-patching`{{}}: This is the configuration that will be used by the AppSec component. In this case, we are going to use the official vpatch rules `crowdsecurity/virtual-patching`{{}}.

* `listen_addr: <ip>:<port>`{{}}: This is the address and port that the acquisition will listen on. In this case, we are going to use `127.0.0.1:4242`{{}}.

* `labels: type: appsec`{{}}: This is a label that will be applied to all events generated by this acquisition. Type `appsec`{{}} is mandatory.

* `name: myappsec`{{}} **optional**: This is the name of the acquisition, it can be anything you want. This is useful when you have multiple acquisitions as the name is provided within the log line.


Let's create the acquistion file using the below snippet:

```
mkdir -p /etc/crowdsec/acquis.d && cat > /etc/crowdsec/acquis.d/appsec.yaml << EOF
source: appsec
name: myappsec
appsec_config: crowdsecurity/virtual-patching
listen_addr: 127.0.0.1:4242
labels:
  type: appsec
EOF
```{{execute T1}}
